# מדריך מערכת האימות ובסיס הנתונים - פוטבול סקאוטינג

מסמך זה מפרט את מערכת האימות ובסיס הנתונים של אתר פוטבול סקאוטינג, וכיצד לגשת לפאנל הניהול.

## מערכת האימות

### סקירה כללית

האתר משתמש במערכת אימות מבוססת **localStorage** בצד הלקוח. זוהי מערכת הדגמה שמדמה שרת אמיתי, אך כל הנתונים נשמרים בדפדפן המקומי של המשתמש.

מערכת האימות מאפשרת:
- הרשמה של שחקנים וסקאוטים
- התחברות והתנתקות
- ניהול הרשאות (שחקן, סקאוט, מנהל)
- עדכון פרטי משתמש

### קבצים רלוונטיים

- `auth/auth.js` - מחלקת האימות הראשית
- `auth/auth-integration.js` - אינטגרציה של מערכת האימות עם ממשק המשתמש

### סוגי משתמשים

המערכת תומכת בשלושה סוגי משתמשים:

1. **שחקן (PLAYER)** - יכול ליצור פרופיל, להשלים אתגרים, לעקוב אחר תוכנית אימון, ולהופיע בטבלאות המובילים
2. **סקאוט (SCOUT)** - יכול לחפש שחקנים, לצפות בפרופילים, ליצור רשימת מעקב, וליצור קשר עם שחקנים
3. **מנהל (ADMIN)** - יכול לנהל את כל המשתמשים, לאשר סרטונים, לעדכן תוכניות אימון, ולנהל את האתר

### חשבון מנהל מוגדר מראש

האתר מגיע עם חשבון מנהל מערכת מוגדר מראש:

- **אימייל**: admin@example.com
- **סיסמה**: admin123

### תהליך האימות

1. **הרשמה**:
   - המשתמש ממלא טופס הרשמה (שחקן או סקאוט)
   - המערכת בודקת אם האימייל כבר קיים
   - אם לא, נוצר משתמש חדש עם סיסמה מוצפנת (הצפנה בסיסית לצורכי הדגמה)
   - המשתמש מתחבר אוטומטית

2. **התחברות**:
   - המשתמש מזין אימייל וסיסמה
   - המערכת בודקת אם האימייל קיים ואם הסיסמה נכונה
   - אם כן, נוצר אובייקט משתמש (ללא הסיסמה) ונשמר ב-localStorage

3. **התנתקות**:
   - מוחק את פרטי המשתמש מ-localStorage
   - מפנה את המשתמש לדף הבית

4. **בדיקת הרשאות**:
   - בדיקה אם המשתמש מחובר
   - בדיקה אם המשתמש הוא מסוג מסוים (שחקן, סקאוט, מנהל)

### קוד לדוגמה

```javascript
// התחברות
auth.login('admin@example.com', 'admin123');

// בדיקה אם המשתמש מחובר
if (auth.isLoggedIn()) {
  // פעולות למשתמש מחובר
}

// בדיקת סוג משתמש
if (auth.isUserType('admin')) {
  // פעולות למנהל בלבד
}

// התנתקות
auth.logout();
```

## בסיס הנתונים

### סקירה כללית

האתר משתמש ב-**localStorage** כבסיס נתונים מקומי. זהו פתרון זמני לצורכי הדגמה, שמדמה בסיס נתונים אמיתי.

### מבנה הנתונים

הנתונים נשמרים במפתחות localStorage הבאים:

1. **footballScout_users** - מכיל את כל המשתמשים הרשומים
2. **footballScout_currentUser** - מכיל את המשתמש המחובר כרגע
3. **footballScout_challenges** - מכיל את האתגרים הזמינים
4. **footballScout_videos** - מכיל את הסרטונים שהועלו
5. **footballScout_trainingPrograms** - מכיל את תוכניות האימון

### מבנה נתוני משתמש

#### שחקן
```javascript
{
  name: "שם השחקן",
  email: "player@example.com",
  password: "הסיסמה המוצפנת",
  type: "player",
  age: 18,
  position: "חלוץ",
  dominantFoot: "ימין",
  level: "מתחיל",
  challenges: {
    initial: {
      completed: false,
      videos: []
    }
  },
  trainingProgram: {
    unlocked: false,
    currentStage: 0,
    completedStages: []
  },
  stats: {
    consistency: 0,
    improvement: 0,
    ranking: 0
  },
  createdAt: "2025-08-29T13:00:00.000Z"
}
```

#### סקאוט
```javascript
{
  name: "שם הסקאוט",
  email: "scout@example.com",
  password: "הסיסמה המוצפנת",
  type: "scout",
  club: "מכבי תל אביב",
  position: "סקאוט ראשי",
  watchlist: [],
  createdAt: "2025-08-29T13:00:00.000Z"
}
```

#### מנהל
```javascript
{
  name: "מנהל מערכת",
  email: "admin@example.com",
  password: "הסיסמה המוצפנת",
  type: "admin",
  createdAt: "2025-08-29T13:00:00.000Z"
}
```

### גישה לנתונים

הגישה לנתונים נעשית דרך מחלקת האימות ומחלקות אחרות:

```javascript
// קבלת כל המשתמשים
const users = auth.getUsers();

// עדכון פרטי משתמש
auth.updateUser('player@example.com', { age: 19 });

// שמירת נתונים חדשים
localStorage.setItem('footballScout_challenges', JSON.stringify(challenges));

// קבלת נתונים
const challenges = JSON.parse(localStorage.getItem('footballScout_challenges') || '[]');
```

## גישה לפאנל הניהול

### כיצד לגשת לפאנל הניהול

1. **התחברות כמנהל**:
   - פתח את האתר בדפדפן
   - לחץ על "התחברות" בתפריט העליון
   - הזן את פרטי המנהל:
     - אימייל: admin@example.com
     - סיסמה: admin123
   - לחץ על "התחבר"

2. **גישה לפאנל הניהול**:
   - לאחר ההתחברות, יופיע קישור "פאנל ניהול" בתפריט העליון
   - לחץ על הקישור כדי לגשת לפאנל הניהול
   - לחלופין, ניתן לגשת ישירות לכתובת `/admin/dashboard.html` לאחר ההתחברות

3. **גישה ישירה**:
   - ניתן גם לגשת ישירות לכתובת `/admin/dashboard.html`
   - אם אינך מחובר כמנהל, תועבר אוטומטית לדף ההתחברות

### תכונות פאנל הניהול

פאנל הניהול מאפשר למנהלי המערכת:

1. **לוח בקרה** (`dashboard.html`):
   - סטטיסטיקות כלליות
   - פעילות אחרונה
   - סרטונים ממתינים לאישור
   - משתמשים חדשים
   - שחקנים מובילים

2. **ניהול משתמשים** (`users.html`):
   - צפייה בכל המשתמשים
   - עריכת פרטי משתמש
   - השעיית משתמשים
   - מחיקת משתמשים

3. **ניהול סרטונים** (`videos.html`):
   - צפייה בסרטונים שהועלו
   - אישור או דחייה של סרטונים
   - הוספת הערות לסרטונים

4. **ניהול תוכניות אימון** (`training.html`):
   - עדכון תוכניות אימון קיימות
   - יצירת תוכניות אימון חדשות
   - הקצאת תוכניות אימון לשחקנים

5. **דוחות** (`reports.html`):
   - צפייה בדוחות שונים
   - ייצוא נתונים

6. **הגדרות** (`settings.html`):
   - הגדרות כלליות של האתר
   - הגדרות אבטחה

### תפריט צד

פאנל הניהול כולל תפריט צד שמאפשר ניווט מהיר בין הדפים השונים:

- לוח בקרה
- משתמשים
- סרטונים
- תוכניות אימון
- דוחות
- הגדרות

בנוסף, יש קישור "חזרה לאתר" בתחתית התפריט, שמאפשר לחזור לאתר הראשי.

## הערות חשובות

1. **אחסון מקומי בלבד**:
   - כל הנתונים נשמרים ב-localStorage של הדפדפן
   - הנתונים לא נשמרים בשרת ויאבדו אם תנקה את נתוני הדפדפן
   - הנתונים לא משותפים בין דפדפנים או מכשירים שונים

2. **אבטחה**:
   - מערכת האימות היא לצורכי הדגמה בלבד
   - הצפנת הסיסמאות היא בסיסית ולא מאובטחת
   - בסביבת ייצור אמיתית, יש להשתמש בשרת אמיתי עם אבטחה מתאימה

3. **פיתוח עתידי**:
   - בפיתוח עתידי, מומלץ להחליף את מערכת האחסון המקומית בשרת אמיתי עם בסיס נתונים
   - ראה את המלצות האבטחה ב-`SECURITY.md` לפרטים נוספים על מעבר לפתרון שרת